(
(let world (Configure! world (DataSource 'config) 'OrderedColumns))
(let read0 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read0))
(let read1 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read1))
(let read2 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read2))
(let read3 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read3))
(let read4 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read4))
(let read5 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read5))
(let output (PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"" (Void) (lambda '() (PgStar))))) '('from '('((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"B1_LP" (Void) (lambda '() (PgAgg '"avg" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B1_CNT" (Void) (lambda '() (PgAgg '"count" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B1_CNTD" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"ss_list_price")))))) '('from '('((Right! read0) '"store_sales" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgBetween (PgColumnRef '"ss_quantity") (PgConst '0 (PgType 'int4)) (PgConst '5 (PgType 'int4))) (PgOr (PgOr (PgBetween (PgColumnRef '"ss_list_price") (PgCast (PgConst '11 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '11 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgType '"numeric"))) (PgBetween (PgColumnRef '"ss_coupon_amt") (PgCast (PgConst '460 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '460 (PgType 'int4)) (PgConst '1000 (PgType 'int4))) (PgType '"numeric")))) (PgBetween (PgColumnRef '"ss_wholesale_cost") (PgCast (PgConst '14 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '14 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgType '"numeric")))))))))))) '('set_ops '('push)))) '"B1" '()) '((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"B2_LP" (Void) (lambda '() (PgAgg '"avg" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B2_CNT" (Void) (lambda '() (PgAgg '"count" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B2_CNTD" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"ss_list_price")))))) '('from '('((Right! read1) '"store_sales" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgBetween (PgColumnRef '"ss_quantity") (PgConst '6 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgOr (PgOr (PgBetween (PgColumnRef '"ss_list_price") (PgCast (PgConst '91 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '91 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgType '"numeric"))) (PgBetween (PgColumnRef '"ss_coupon_amt") (PgCast (PgConst '1430 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '1430 (PgType 'int4)) (PgConst '1000 (PgType 'int4))) (PgType '"numeric")))) (PgBetween (PgColumnRef '"ss_wholesale_cost") (PgCast (PgConst '32 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '32 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgType '"numeric")))))))))))) '('set_ops '('push)))) '"B2" '()) '((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"B3_LP" (Void) (lambda '() (PgAgg '"avg" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B3_CNT" (Void) (lambda '() (PgAgg '"count" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B3_CNTD" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"ss_list_price")))))) '('from '('((Right! read2) '"store_sales" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgBetween (PgColumnRef '"ss_quantity") (PgConst '11 (PgType 'int4)) (PgConst '15 (PgType 'int4))) (PgOr (PgOr (PgBetween (PgColumnRef '"ss_list_price") (PgCast (PgConst '66 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '66 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgType '"numeric"))) (PgBetween (PgColumnRef '"ss_coupon_amt") (PgCast (PgConst '920 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '920 (PgType 'int4)) (PgConst '1000 (PgType 'int4))) (PgType '"numeric")))) (PgBetween (PgColumnRef '"ss_wholesale_cost") (PgCast (PgConst '4 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '4 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgType '"numeric")))))))))))) '('set_ops '('push)))) '"B3" '()) '((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"B4_LP" (Void) (lambda '() (PgAgg '"avg" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B4_CNT" (Void) (lambda '() (PgAgg '"count" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B4_CNTD" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"ss_list_price")))))) '('from '('((Right! read3) '"store_sales" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgBetween (PgColumnRef '"ss_quantity") (PgConst '16 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgOr (PgOr (PgBetween (PgColumnRef '"ss_list_price") (PgCast (PgConst '142 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '142 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgType '"numeric"))) (PgBetween (PgColumnRef '"ss_coupon_amt") (PgCast (PgConst '3054 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '3054 (PgType 'int4)) (PgConst '1000 (PgType 'int4))) (PgType '"numeric")))) (PgBetween (PgColumnRef '"ss_wholesale_cost") (PgCast (PgConst '80 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '80 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgType '"numeric")))))))))))) '('set_ops '('push)))) '"B4" '()) '((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"B5_LP" (Void) (lambda '() (PgAgg '"avg" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B5_CNT" (Void) (lambda '() (PgAgg '"count" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B5_CNTD" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"ss_list_price")))))) '('from '('((Right! read4) '"store_sales" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgBetween (PgColumnRef '"ss_quantity") (PgConst '21 (PgType 'int4)) (PgConst '25 (PgType 'int4))) (PgOr (PgOr (PgBetween (PgColumnRef '"ss_list_price") (PgCast (PgConst '135 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '135 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgType '"numeric"))) (PgBetween (PgColumnRef '"ss_coupon_amt") (PgCast (PgConst '14180 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '14180 (PgType 'int4)) (PgConst '1000 (PgType 'int4))) (PgType '"numeric")))) (PgBetween (PgColumnRef '"ss_wholesale_cost") (PgCast (PgConst '38 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '38 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgType '"numeric")))))))))))) '('set_ops '('push)))) '"B5" '()) '((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"B6_LP" (Void) (lambda '() (PgAgg '"avg" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B6_CNT" (Void) (lambda '() (PgAgg '"count" '() (PgColumnRef '"ss_list_price")))) (PgResultItem '"B6_CNTD" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"ss_list_price")))))) '('from '('((Right! read5) '"store_sales" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgBetween (PgColumnRef '"ss_quantity") (PgConst '26 (PgType 'int4)) (PgConst '30 (PgType 'int4))) (PgOr (PgOr (PgBetween (PgColumnRef '"ss_list_price") (PgCast (PgConst '28 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '28 (PgType 'int4)) (PgConst '10 (PgType 'int4))) (PgType '"numeric"))) (PgBetween (PgColumnRef '"ss_coupon_amt") (PgCast (PgConst '2513 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '2513 (PgType 'int4)) (PgConst '1000 (PgType 'int4))) (PgType '"numeric")))) (PgBetween (PgColumnRef '"ss_wholesale_cost") (PgCast (PgConst '42 (PgType 'int4)) (PgType '"numeric")) (PgCast (PgOp '"+" (PgConst '42 (PgType 'int4)) (PgConst '20 (PgType 'int4))) (PgType '"numeric")))))))))))) '('set_ops '('push)))) '"B6" '()))) '('join_ops '('() '() '() '() '() '())))))) '('set_ops '('push)) '('limit (PgConst '100 (PgType 'int4))))))
(let result_sink (DataSink 'result))
(let world (Write! world result_sink (Key) output '('('type) '('autoref))))
(let world (Commit! world result_sink))
(let world (CommitAll! world))
(return world)
)
