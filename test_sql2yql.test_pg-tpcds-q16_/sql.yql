(
(let world (Configure! world (DataSource 'config) 'OrderedColumns))
(let read0 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"catalog_sales"))) (Void) '()))
(let world (Left! read0))
(let read1 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"date_dim"))) (Void) '()))
(let world (Left! read1))
(let read2 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"customer_address"))) (Void) '()))
(let world (Left! read2))
(let read3 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"call_center"))) (Void) '()))
(let world (Left! read3))
(let read4 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"catalog_sales"))) (Void) '()))
(let world (Left! read4))
(let read5 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"catalog_returns"))) (Void) '()))
(let world (Left! read5))
(let output (PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"order count" (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"cs_order_number")))) (PgResultItem '"total shipping cost" (Void) (lambda '() (PgAgg '"sum" '() (PgColumnRef '"cs_ext_ship_cost")))) (PgResultItem '"total net profit" (Void) (lambda '() (PgAgg '"sum" '() (PgColumnRef '"cs_net_profit")))))) '('from '('((Right! read0) '"cs1" '()) '((Right! read1) '"date_dim" '()) '((Right! read2) '"customer_address" '()) '((Right! read3) '"call_center" '()))) '('join_ops '('() '() '() '())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgAnd (PgAnd (PgAnd (PgAnd (PgAnd (PgAnd (PgBetween (PgColumnRef '"d_date") (PgCast (PgConst '"1999-2-01" (PgType 'text)) (PgType '"date")) (PgCast (PgOp '"+" (PgCast (PgConst '"1999-2-01" (PgType 'text)) (PgType '"date")) (PgCast (PgConst '"60" (PgType 'text)) (PgType '"interval") (PgCall 'intervaltypmodin '() (PgArray (PgConst '"8" (PgType 'cstring)))))) (PgType '"date"))) (PgOp '"=" (PgColumnRef '"cs1" '"cs_ship_date_sk") (PgColumnRef '"d_date_sk"))) (PgOp '"=" (PgColumnRef '"cs1" '"cs_ship_addr_sk") (PgColumnRef '"ca_address_sk"))) (PgOp '"=" (PgColumnRef '"ca_state") (PgConst '"IL" (PgType 'text)))) (PgOp '"=" (PgColumnRef '"cs1" '"cs_call_center_sk") (PgColumnRef '"cc_call_center_sk"))) (PgIn (PgColumnRef '"cc_county") (AsList (PgConst '"Williamson County" (PgType 'text)) (PgConst '"Williamson County" (PgType 'text)) (PgConst '"Williamson County" (PgType 'text)) (PgConst '"Williamson County" (PgType 'text)) (PgConst '"Williamson County" (PgType 'text))))) (PgSubLink 'exists (Void) (Void) (Void) (lambda '() (PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"" (Void) (lambda '() (PgStar))))) '('from '('((Right! read4) '"cs2" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgOp '"=" (PgColumnRef '"cs1" '"cs_order_number") (PgColumnRef '"cs2" '"cs_order_number")) (PgOp '"<>" (PgColumnRef '"cs1" '"cs_warehouse_sk") (PgColumnRef '"cs2" '"cs_warehouse_sk")))))))))) '('set_ops '('push))))))) (PgNot (PgSubLink 'exists (Void) (Void) (Void) (lambda '() (PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"" (Void) (lambda '() (PgStar))))) '('from '('((Right! read5) '"cr1" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgOp '"=" (PgColumnRef '"cs1" '"cs_order_number") (PgColumnRef '"cr1" '"cr_order_number"))))))))) '('set_ops '('push))))))))))) '('sort '((PgSort (Void) (lambda '() (PgAgg '"count" '('('distinct)) (PgColumnRef '"cs_order_number"))) 'asc))))))) '('set_ops '('push)) '('limit (PgConst '100 (PgType 'int4))))))
(let result_sink (DataSink 'result))
(let world (Write! world result_sink (Key) output '('('type) '('autoref))))
(let world (Commit! world result_sink))
(let world (CommitAll! world))
(return world)
)
