(
(let world (Configure! world (DataSource 'config) 'OrderedColumns))
(let read0 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store_sales"))) (Void) '()))
(let world (Left! read0))
(let read1 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"date_dim"))) (Void) '()))
(let world (Left! read1))
(let read2 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"store"))) (Void) '()))
(let world (Left! read2))
(let read3 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"customer_address"))) (Void) '()))
(let world (Left! read3))
(let read4 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"customer_address"))) (Void) '()))
(let world (Left! read4))
(let read5 (Read! world (DataSource '"yt" '"plato") (Key '('table (String '"customer"))) (Void) '()))
(let world (Left! read5))
(let output (PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"s_store_name" (Void) (lambda '() (PgColumnRef '"s_store_name"))) (PgResultItem '"column0" (Void) (lambda '() (PgAgg '"sum" '() (PgColumnRef '"ss_net_profit")))))) '('from '('((Right! read0) '"store_sales" '()) '((Right! read1) '"date_dim" '()) '((Right! read2) '"store" '()) '((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"ca_zip" (Void) (lambda '() (PgColumnRef '"ca_zip"))))) '('from '('((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"ca_zip" (Void) (lambda '() (PgCall '"substr" '() (PgColumnRef '"ca_zip") (PgConst '1 (PgType 'int4)) (PgConst '5 (PgType 'int4))))))) '('from '('((Right! read3) '"customer_address" '()))) '('join_ops '('())) '('where (PgWhere (Void) (lambda '() (PgIn (PgCall '"substr" '() (PgColumnRef '"ca_zip") (PgConst '1 (PgType 'int4)) (PgConst '5 (PgType 'int4))) (AsList (PgConst '"89436" (PgType 'text)) (PgConst '"30868" (PgType 'text)) (PgConst '"65085" (PgType 'text)) (PgConst '"22977" (PgType 'text)) (PgConst '"83927" (PgType 'text)) (PgConst '"77557" (PgType 'text)) (PgConst '"58429" (PgType 'text)) (PgConst '"40697" (PgType 'text)) (PgConst '"80614" (PgType 'text)) (PgConst '"10502" (PgType 'text)) (PgConst '"32779" (PgType 'text)) (PgConst '"91137" (PgType 'text)) (PgConst '"61265" (PgType 'text)) (PgConst '"98294" (PgType 'text)) (PgConst '"17921" (PgType 'text)) (PgConst '"18427" (PgType 'text)) (PgConst '"21203" (PgType 'text)) (PgConst '"59362" (PgType 'text)) (PgConst '"87291" (PgType 'text)) (PgConst '"84093" (PgType 'text)) (PgConst '"21505" (PgType 'text)) (PgConst '"17184" (PgType 'text)) (PgConst '"10866" (PgType 'text)) (PgConst '"67898" (PgType 'text)) (PgConst '"25797" (PgType 'text)) (PgConst '"28055" (PgType 'text)) (PgConst '"18377" (PgType 'text)) (PgConst '"80332" (PgType 'text)) (PgConst '"74535" (PgType 'text)) (PgConst '"21757" (PgType 'text)) (PgConst '"29742" (PgType 'text)) (PgConst '"90885" (PgType 'text)) (PgConst '"29898" (PgType 'text)) (PgConst '"17819" (PgType 'text)) (PgConst '"40811" (PgType 'text)) (PgConst '"25990" (PgType 'text)) (PgConst '"47513" (PgType 'text)) (PgConst '"89531" (PgType 'text)) (PgConst '"91068" (PgType 'text)) (PgConst '"10391" (PgType 'text)) (PgConst '"18846" (PgType 'text)) (PgConst '"99223" (PgType 'text)) (PgConst '"82637" (PgType 'text)) (PgConst '"41368" (PgType 'text)) (PgConst '"83658" (PgType 'text)) (PgConst '"86199" (PgType 'text)) (PgConst '"81625" (PgType 'text)) (PgConst '"26696" (PgType 'text)) (PgConst '"89338" (PgType 'text)) (PgConst '"88425" (PgType 'text)) (PgConst '"32200" (PgType 'text)) (PgConst '"81427" (PgType 'text)) (PgConst '"19053" (PgType 'text)) (PgConst '"77471" (PgType 'text)) (PgConst '"36610" (PgType 'text)) (PgConst '"99823" (PgType 'text)) (PgConst '"43276" (PgType 'text)) (PgConst '"41249" (PgType 'text)) (PgConst '"48584" (PgType 'text)) (PgConst '"83550" (PgType 'text)) (PgConst '"82276" (PgType 'text)) (PgConst '"18842" (PgType 'text)) (PgConst '"78890" (PgType 'text)) (PgConst '"14090" (PgType 'text)) (PgConst '"38123" (PgType 'text)) (PgConst '"40936" (PgType 'text)) (PgConst '"34425" (PgType 'text)) (PgConst '"19850" (PgType 'text)) (PgConst '"43286" (PgType 'text)) (PgConst '"80072" (PgType 'text)) (PgConst '"79188" (PgType 'text)) (PgConst '"54191" (PgType 'text)) (PgConst '"11395" (PgType 'text)) (PgConst '"50497" (PgType 'text)) (PgConst '"84861" (PgType 'text)) (PgConst '"90733" (PgType 'text)) (PgConst '"21068" (PgType 'text)) (PgConst '"57666" (PgType 'text)) (PgConst '"37119" (PgType 'text)) (PgConst '"25004" (PgType 'text)) (PgConst '"57835" (PgType 'text)) (PgConst '"70067" (PgType 'text)) (PgConst '"62878" (PgType 'text)) (PgConst '"95806" (PgType 'text)) (PgConst '"19303" (PgType 'text)) (PgConst '"18840" (PgType 'text)) (PgConst '"19124" (PgType 'text)) (PgConst '"29785" (PgType 'text)) (PgConst '"16737" (PgType 'text)) (PgConst '"16022" (PgType 'text)) (PgConst '"49613" (PgType 'text)) (PgConst '"89977" (PgType 'text)) (PgConst '"68310" (PgType 'text)) (PgConst '"60069" (PgType 'text)) (PgConst '"98360" (PgType 'text)) (PgConst '"48649" (PgType 'text)) (PgConst '"39050" (PgType 'text)) (PgConst '"41793" (PgType 'text)) (PgConst '"25002" (PgType 'text)) (PgConst '"27413" (PgType 'text)) (PgConst '"39736" (PgType 'text)) (PgConst '"47208" (PgType 'text)) (PgConst '"16515" (PgType 'text)) (PgConst '"94808" (PgType 'text)) (PgConst '"57648" (PgType 'text)) (PgConst '"15009" (PgType 'text)) (PgConst '"80015" (PgType 'text)) (PgConst '"42961" (PgType 'text)) (PgConst '"63982" (PgType 'text)) (PgConst '"21744" (PgType 'text)) (PgConst '"71853" (PgType 'text)) (PgConst '"81087" (PgType 'text)) (PgConst '"67468" (PgType 'text)) (PgConst '"34175" (PgType 'text)) (PgConst '"64008" (PgType 'text)) (PgConst '"20261" (PgType 'text)) (PgConst '"11201" (PgType 'text)) (PgConst '"51799" (PgType 'text)) (PgConst '"48043" (PgType 'text)) (PgConst '"45645" (PgType 'text)) (PgConst '"61163" (PgType 'text)) (PgConst '"48375" (PgType 'text)) (PgConst '"36447" (PgType 'text)) (PgConst '"57042" (PgType 'text)) (PgConst '"21218" (PgType 'text)) (PgConst '"41100" (PgType 'text)) (PgConst '"89951" (PgType 'text)) (PgConst '"22745" (PgType 'text)) (PgConst '"35851" (PgType 'text)) (PgConst '"83326" (PgType 'text)) (PgConst '"61125" (PgType 'text)) (PgConst '"78298" (PgType 'text)) (PgConst '"80752" (PgType 'text)) (PgConst '"49858" (PgType 'text)) (PgConst '"52940" (PgType 'text)) (PgConst '"96976" (PgType 'text)) (PgConst '"63792" (PgType 'text)) (PgConst '"11376" (PgType 'text)) (PgConst '"53582" (PgType 'text)) (PgConst '"18717" (PgType 'text)) (PgConst '"90226" (PgType 'text)) (PgConst '"50530" (PgType 'text)) (PgConst '"94203" (PgType 'text)) (PgConst '"99447" (PgType 'text)) (PgConst '"27670" (PgType 'text)) (PgConst '"96577" (PgType 'text)) (PgConst '"57856" (PgType 'text)) (PgConst '"56372" (PgType 'text)) (PgConst '"16165" (PgType 'text)) (PgConst '"23427" (PgType 'text)) (PgConst '"54561" (PgType 'text)) (PgConst '"28806" (PgType 'text)) (PgConst '"44439" (PgType 'text)) (PgConst '"22926" (PgType 'text)) (PgConst '"30123" (PgType 'text)) (PgConst '"61451" (PgType 'text)) (PgConst '"92397" (PgType 'text)) (PgConst '"56979" (PgType 'text)) (PgConst '"92309" (PgType 'text)) (PgConst '"70873" (PgType 'text)) (PgConst '"13355" (PgType 'text)) (PgConst '"21801" (PgType 'text)) (PgConst '"46346" (PgType 'text)) (PgConst '"37562" (PgType 'text)) (PgConst '"56458" (PgType 'text)) (PgConst '"28286" (PgType 'text)) (PgConst '"47306" (PgType 'text)) (PgConst '"99555" (PgType 'text)) (PgConst '"69399" (PgType 'text)) (PgConst '"26234" (PgType 'text)) (PgConst '"47546" (PgType 'text)) (PgConst '"49661" (PgType 'text)) (PgConst '"88601" (PgType 'text)) (PgConst '"35943" (PgType 'text)) (PgConst '"39936" (PgType 'text)) (PgConst '"25632" (PgType 'text)) (PgConst '"24611" (PgType 'text)) (PgConst '"44166" (PgType 'text)) (PgConst '"56648" (PgType 'text)) (PgConst '"30379" (PgType 'text)) (PgConst '"59785" (PgType 'text)) (PgConst '"11110" (PgType 'text)) (PgConst '"14329" (PgType 'text)) (PgConst '"93815" (PgType 'text)) (PgConst '"52226" (PgType 'text)) (PgConst '"71381" (PgType 'text)) (PgConst '"13842" (PgType 'text)) (PgConst '"25612" (PgType 'text)) (PgConst '"63294" (PgType 'text)) (PgConst '"14664" (PgType 'text)) (PgConst '"21077" (PgType 'text)) (PgConst '"82626" (PgType 'text)) (PgConst '"18799" (PgType 'text)) (PgConst '"60915" (PgType 'text)) (PgConst '"81020" (PgType 'text)) (PgConst '"56447" (PgType 'text)) (PgConst '"76619" (PgType 'text)) (PgConst '"11433" (PgType 'text)) (PgConst '"13414" (PgType 'text)) (PgConst '"42548" (PgType 'text)) (PgConst '"92713" (PgType 'text)) (PgConst '"70467" (PgType 'text)) (PgConst '"30884" (PgType 'text)) (PgConst '"47484" (PgType 'text)) (PgConst '"16072" (PgType 'text)) (PgConst '"38936" (PgType 'text)) (PgConst '"13036" (PgType 'text)) (PgConst '"88376" (PgType 'text)) (PgConst '"45539" (PgType 'text)) (PgConst '"35901" (PgType 'text)) (PgConst '"19506" (PgType 'text)) (PgConst '"65690" (PgType 'text)) (PgConst '"73957" (PgType 'text)) (PgConst '"71850" (PgType 'text)) (PgConst '"49231" (PgType 'text)) (PgConst '"14276" (PgType 'text)) (PgConst '"20005" (PgType 'text)) (PgConst '"18384" (PgType 'text)) (PgConst '"76615" (PgType 'text)) (PgConst '"11635" (PgType 'text)) (PgConst '"38177" (PgType 'text)) (PgConst '"55607" (PgType 'text)) (PgConst '"41369" (PgType 'text)) (PgConst '"95447" (PgType 'text)) (PgConst '"58581" (PgType 'text)) (PgConst '"58149" (PgType 'text)) (PgConst '"91946" (PgType 'text)) (PgConst '"33790" (PgType 'text)) (PgConst '"76232" (PgType 'text)) (PgConst '"75692" (PgType 'text)) (PgConst '"95464" (PgType 'text)) (PgConst '"22246" (PgType 'text)) (PgConst '"51061" (PgType 'text)) (PgConst '"56692" (PgType 'text)) (PgConst '"53121" (PgType 'text)) (PgConst '"77209" (PgType 'text)) (PgConst '"15482" (PgType 'text)) (PgConst '"10688" (PgType 'text)) (PgConst '"14868" (PgType 'text)) (PgConst '"45907" (PgType 'text)) (PgConst '"73520" (PgType 'text)) (PgConst '"72666" (PgType 'text)) (PgConst '"25734" (PgType 'text)) (PgConst '"17959" (PgType 'text)) (PgConst '"24677" (PgType 'text)) (PgConst '"66446" (PgType 'text)) (PgConst '"94627" (PgType 'text)) (PgConst '"53535" (PgType 'text)) (PgConst '"15560" (PgType 'text)) (PgConst '"41967" (PgType 'text)) (PgConst '"69297" (PgType 'text)) (PgConst '"11929" (PgType 'text)) (PgConst '"59403" (PgType 'text)) (PgConst '"33283" (PgType 'text)) (PgConst '"52232" (PgType 'text)) (PgConst '"57350" (PgType 'text)) (PgConst '"43933" (PgType 'text)) (PgConst '"40921" (PgType 'text)) (PgConst '"36635" (PgType 'text)) (PgConst '"10827" (PgType 'text)) (PgConst '"71286" (PgType 'text)) (PgConst '"19736" (PgType 'text)) (PgConst '"80619" (PgType 'text)) (PgConst '"25251" (PgType 'text)) (PgConst '"95042" (PgType 'text)) (PgConst '"15526" (PgType 'text)) (PgConst '"36496" (PgType 'text)) (PgConst '"55854" (PgType 'text)) (PgConst '"49124" (PgType 'text)) (PgConst '"81980" (PgType 'text)) (PgConst '"35375" (PgType 'text)) (PgConst '"49157" (PgType 'text)) (PgConst '"63512" (PgType 'text)) (PgConst '"28944" (PgType 'text)) (PgConst '"14946" (PgType 'text)) (PgConst '"36503" (PgType 'text)) (PgConst '"54010" (PgType 'text)) (PgConst '"18767" (PgType 'text)) (PgConst '"23969" (PgType 'text)) (PgConst '"43905" (PgType 'text)) (PgConst '"66979" (PgType 'text)) (PgConst '"33113" (PgType 'text)) (PgConst '"21286" (PgType 'text)) (PgConst '"58471" (PgType 'text)) (PgConst '"59080" (PgType 'text)) (PgConst '"13395" (PgType 'text)) (PgConst '"79144" (PgType 'text)) (PgConst '"70373" (PgType 'text)) (PgConst '"67031" (PgType 'text)) (PgConst '"38360" (PgType 'text)) (PgConst '"26705" (PgType 'text)) (PgConst '"50906" (PgType 'text)) (PgConst '"52406" (PgType 'text)) (PgConst '"26066" (PgType 'text)) (PgConst '"73146" (PgType 'text)) (PgConst '"15884" (PgType 'text)) (PgConst '"31897" (PgType 'text)) (PgConst '"30045" (PgType 'text)) (PgConst '"61068" (PgType 'text)) (PgConst '"45550" (PgType 'text)) (PgConst '"92454" (PgType 'text)) (PgConst '"13376" (PgType 'text)) (PgConst '"14354" (PgType 'text)) (PgConst '"19770" (PgType 'text)) (PgConst '"22928" (PgType 'text)) (PgConst '"97790" (PgType 'text)) (PgConst '"50723" (PgType 'text)) (PgConst '"46081" (PgType 'text)) (PgConst '"30202" (PgType 'text)) (PgConst '"14410" (PgType 'text)) (PgConst '"20223" (PgType 'text)) (PgConst '"88500" (PgType 'text)) (PgConst '"67298" (PgType 'text)) (PgConst '"13261" (PgType 'text)) (PgConst '"14172" (PgType 'text)) (PgConst '"81410" (PgType 'text)) (PgConst '"93578" (PgType 'text)) (PgConst '"83583" (PgType 'text)) (PgConst '"46047" (PgType 'text)) (PgConst '"94167" (PgType 'text)) (PgConst '"82564" (PgType 'text)) (PgConst '"21156" (PgType 'text)) (PgConst '"15799" (PgType 'text)) (PgConst '"86709" (PgType 'text)) (PgConst '"37931" (PgType 'text)) (PgConst '"74703" (PgType 'text)) (PgConst '"83103" (PgType 'text)) (PgConst '"23054" (PgType 'text)) (PgConst '"70470" (PgType 'text)) (PgConst '"72008" (PgType 'text)) (PgConst '"49247" (PgType 'text)) (PgConst '"91911" (PgType 'text)) (PgConst '"69998" (PgType 'text)) (PgConst '"20961" (PgType 'text)) (PgConst '"70070" (PgType 'text)) (PgConst '"63197" (PgType 'text)) (PgConst '"54853" (PgType 'text)) (PgConst '"88191" (PgType 'text)) (PgConst '"91830" (PgType 'text)) (PgConst '"49521" (PgType 'text)) (PgConst '"19454" (PgType 'text)) (PgConst '"81450" (PgType 'text)) (PgConst '"89091" (PgType 'text)) (PgConst '"62378" (PgType 'text)) (PgConst '"25683" (PgType 'text)) (PgConst '"61869" (PgType 'text)) (PgConst '"51744" (PgType 'text)) (PgConst '"36580" (PgType 'text)) (PgConst '"85778" (PgType 'text)) (PgConst '"36871" (PgType 'text)) (PgConst '"48121" (PgType 'text)) (PgConst '"28810" (PgType 'text)) (PgConst '"83712" (PgType 'text)) (PgConst '"45486" (PgType 'text)) (PgConst '"67393" (PgType 'text)) (PgConst '"26935" (PgType 'text)) (PgConst '"42393" (PgType 'text)) (PgConst '"20132" (PgType 'text)) (PgConst '"55349" (PgType 'text)) (PgConst '"86057" (PgType 'text)) (PgConst '"21309" (PgType 'text)) (PgConst '"80218" (PgType 'text)) (PgConst '"10094" (PgType 'text)) (PgConst '"11357" (PgType 'text)) (PgConst '"48819" (PgType 'text)) (PgConst '"39734" (PgType 'text)) (PgConst '"40758" (PgType 'text)) (PgConst '"30432" (PgType 'text)) (PgConst '"21204" (PgType 'text)) (PgConst '"29467" (PgType 'text)) (PgConst '"30214" (PgType 'text)) (PgConst '"61024" (PgType 'text)) (PgConst '"55307" (PgType 'text)) (PgConst '"74621" (PgType 'text)) (PgConst '"11622" (PgType 'text)) (PgConst '"68908" (PgType 'text)) (PgConst '"33032" (PgType 'text)) (PgConst '"52868" (PgType 'text)) (PgConst '"99194" (PgType 'text)) (PgConst '"99900" (PgType 'text)) (PgConst '"84936" (PgType 'text)) (PgConst '"69036" (PgType 'text)) (PgConst '"99149" (PgType 'text)) (PgConst '"45013" (PgType 'text)) (PgConst '"32895" (PgType 'text)) (PgConst '"59004" (PgType 'text)) (PgConst '"32322" (PgType 'text)) (PgConst '"14933" (PgType 'text)) (PgConst '"32936" (PgType 'text)) (PgConst '"33562" (PgType 'text)) (PgConst '"72550" (PgType 'text)) (PgConst '"27385" (PgType 'text)) (PgConst '"58049" (PgType 'text)) (PgConst '"58200" (PgType 'text)) (PgConst '"16808" (PgType 'text)) (PgConst '"21360" (PgType 'text)) (PgConst '"32961" (PgType 'text)) (PgConst '"18586" (PgType 'text)) (PgConst '"79307" (PgType 'text)) (PgConst '"15492" (PgType 'text))))))))) (PgSetItem '('('result '((PgResultItem '"ca_zip" (Void) (lambda '() (PgColumnRef '"ca_zip"))))) '('from '('((PgSelect '('('set_items '((PgSetItem '('('result '((PgResultItem '"ca_zip" (Void) (lambda '() (PgCall '"substr" '() (PgColumnRef '"ca_zip") (PgConst '1 (PgType 'int4)) (PgConst '5 (PgType 'int4))))) (PgResultItem '"cnt" (Void) (lambda '() (PgAgg '"count" '()))))) '('from '('((Right! read4) '"customer_address" '()) '((Right! read5) '"customer" '()))) '('join_ops '('() '())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgOp '"=" (PgColumnRef '"ca_address_sk") (PgColumnRef '"c_current_addr_sk")) (PgOp '"=" (PgColumnRef '"c_preferred_cust_flag") (PgConst '"Y" (PgType 'text))))))) '('group_by '((PgGroup (Void) (lambda '() (PgColumnRef '"ca_zip"))))) '('having (PgWhere (Void) (lambda '() (PgOp '">" (PgAgg '"count" '()) (PgConst '10 (PgType 'int4)))))))))) '('set_ops '('push)))) '"A1" '()))) '('join_ops '('())))))) '('set_ops '('push 'push 'intersect)))) '"A2" '()))) '('join_ops '('())))))) '('set_ops '('push)))) '"V1" '()))) '('join_ops '('() '() '() '())) '('where (PgWhere (Void) (lambda '() (PgAnd (PgAnd (PgAnd (PgAnd (PgOp '"=" (PgColumnRef '"ss_store_sk") (PgColumnRef '"s_store_sk")) (PgOp '"=" (PgColumnRef '"ss_sold_date_sk") (PgColumnRef '"d_date_sk"))) (PgOp '"=" (PgColumnRef '"d_qoy") (PgConst '1 (PgType 'int4)))) (PgOp '"=" (PgColumnRef '"d_year") (PgConst '2002 (PgType 'int4)))) (PgOp '"=" (PgCall '"substr" '() (PgColumnRef '"s_zip") (PgConst '1 (PgType 'int4)) (PgConst '2 (PgType 'int4))) (PgCall '"substr" '() (PgColumnRef '"V1" '"ca_zip") (PgConst '1 (PgType 'int4)) (PgConst '2 (PgType 'int4)))))))) '('group_by '((PgGroup (Void) (lambda '() (PgColumnRef '"s_store_name"))))) '('sort '((PgSort (Void) (lambda '() (PgColumnRef '"s_store_name")) 'asc))))))) '('set_ops '('push)) '('limit (PgConst '100 (PgType 'int4))))))
(let result_sink (DataSink 'result))
(let world (Write! world result_sink (Key) output '('('type) '('autoref))))
(let world (Commit! world result_sink))
(let world (CommitAll! world))
(return world)
)
